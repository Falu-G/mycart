/*! Copyright © 2015 accengage-web-sdk 2.0.8 by Accengage */
"use strict";!function(a){"AccengageWebSDKObject"in a&&!function(a){function b(){if(e()&&d()){if(1===a.i.initFlag)return g.settings=h,g.utils.setContext(a.i),g.mode=g.MODE.TOP,g.top.prepare();if(2===a.i.initFlag){if(g.settings=h,g.utils.setContext(a.i),g.context.window.name===g.MODE.MIDDLE.PROXY)return g.mode=g.MODE.MIDDLE.PROXY,g.middle.prepare();if(g.context.window.name===g.MODE.MIDDLE.BRIDGE)return g.mode=g.MODE.MIDDLE.BRIDGE,g.middle.prepare()}}}function c(){return"function"!==f(a)?!1:"boolean"===f(a.a)?!1:(a.a=!0,"object"!==f(a.i)?!1:!0)}function d(){return"number"===f(a.i.date)&&["global","window"].indexOf(-1!==f(a.i.window))&&"htmldocument"===f(a.i.document)&&"number"===f(a.i.initFlag)}function e(){return"string"!==f(h.partnerId)||""===h.partnerId?!1:"string"!==f(h.A4SKey)||""===h.A4SKey?!1:!0}function f(a){var b=Object.prototype.toString.call(a);return b.slice(8,b.length-1).toLowerCase()}if(c()){var g={};g.MODE={NONE:"none",TOP:"acc_top",MIDDLE:{PROXY:"acc_proxy",BRIDGE:"acc_bridge"},OTHER:{LANDING_PUSH_OPTINISATION:"acc_landing_push_optinisation"}},g.MASTER={BASE:"/pushweb/assets",PATH_TO_MIDDLE:"/m_main.html",PATH_TO_LANDING:"/index.html",PATH_TO_CONFIG:"/config.json",PATH_TO_WW:"/d_main.js",PATH_TO_SW:"/"},g.CDN={DOMAIN:"websdk.accengage.net",BASE:""},g.WIDGET={DEBUG:"debug",SUBTRACK:"subtrack"};var h={partnerId:"rocketinterneteb194df04631d8c",A4SKey:"bndkdev",alias:"jumia-by.accengage.net",version:"v2.0.x","default":{urlClick:"https://www.jumia.com.ng/",icon:"https://mobilecrm.accengage.com/images/logo_application/1498.JPG"},dependencies:{"push":{"scenario":"none","alertOptions":{"reAskingDelay":168,"theme":"blank","contents":{"misc":{"en":"<div class=\"grid3\"><center><img src=\"https://static.jumia.com.ng/cms/Best%20of%20Whats%20New/jumia_logo_cart.png\" style=\"width: 70%; vertical-align: middle; margin-top: 30%;\" class=\"image1\" alt=\"\"></center></div><div class=\"grid9\"><p id=\"acc-alert-content\" style=\"padding-top: 0px !important;\">We would love to keep you updated about our latest deals.</p><p id=\"acc-alert-subcontent\">Deactivate alerts anytime through browser settings</p></div>","fr":"<div class=\"grid3\"><center><img src=\"https://static.jumia.com.ng/cms/Best%20of%20Whats%20New/jumia_logo_cart.png\" style=\"width: 70%; vertical-align: middle; margin-top: 30%;\" class=\"image1\" alt=\"\"></center></div><div class=\"grid9\"><p id=\"acc-alert-content\" style=\"padding-top: 0px !important;\">Acceptez-vous de recevoir des alertes sur nos dernières offres?</p><p id=\"acc-alert-subcontent\">Désactivez les alertes à tout moment depuis les paramètres</p></div>"},"deny":{"en":"Don't Allow","fr":"Non Merci"},"accept":{"en":"Allow","fr":"OK!"}}}}},widgets:{}};g.settings={},g.context={},g.references={proxy:null,down:null},g.mode=g.MODE.NONE,g.eventManager=function(){var a={},b=function(a){return"object"==typeof a&&"object"==typeof a.data&&"string"==typeof a.data.type};return{getMessageBody:function(a){var b;try{b=JSON.parse(a.data.body)}catch(c){return a.data.body}return b},getMessageTopic:function(a){return"string"==typeof a.data.topic?a.data.topic:void 0},getMessageType:function(a){return"string"==typeof a.data.type?a.data.type:void 0},list:function(){return a},bind:function(a){var b;for(b in a)this.add(b,a[b])},add:function(b,c){a[b]=c},remove:function(b){delete a[b]},exist:function(b){return a.hasOwnProperty(b)},trigger:function(c){var d,e;if(!b(c))return void g.widgetManager.fire(g.WIDGET.DEBUG,{type:"error",callee:"manager:event",contents:["event error",c]});d=this.getMessageType(c);{if(this.exist(d))return a[d].apply(this,[c]);if(g.widgetManager.fire(g.WIDGET.DEBUG,{type:"warning",callee:"manager:event",contents:["event type does not exist in "+g.mode,c]}),e=this.getMessageTopic(c))return g.utils.downwardFeedback(e,null,"event type error")}}}}(),g.logicManager=function(){var a={};return{list:function(){return a},add:function(b,c){a[b]=c},exist:function(b){return a.hasOwnProperty(b)},remove:function(b){delete a[b]},apply:function(b,c,d){try{if(d=d||{},!a.hasOwnProperty(b))throw new Error("Unknown method");return a[b].apply(g,[c,d])}catch(e){var h="misc error";if("string"===f(e)?h=e:"error"!==f(e)||g.utils.empty(e.message)||(h=e.message),"onError"in d)return d.onError.apply(this,[h]);throw h}}}}(),g.dependencyManager=function(){var a={},b=[],c=[],d=!1;return{dependencyLoaded:function(a){b.push(a)},dependencyPrepared:function(a){c.push(a)},getDependenciesLoaded:function(){return b},getDependenciesPrepared:function(){return c},getIncludedRessources:function(){return a},isSDKLoaded:function(){return d},isDependencyLoaded:function(a){return-1!==b.indexOf(a)},isDependencyPrepared:function(a){return-1!==c.indexOf(a)},prepareDependency:function(a){g.utils.empty(g[a])||"function"!==g.utils.extendedTypeOf(g[a].prepare)||g[a].prepare()},ressourceIncluded:function(b,c){a.hasOwnProperty(b)||(a[b]=[]),a[b].push(c)},SDKLoaded:function(){d=!0},startDependencies:function(){for(var a=g.dependencyManager.getDependenciesLoaded(),b=0;b<a.length;b++)g.utils.empty(g[a[b]])||"function"!==g.utils.extendedTypeOf(g[a[b]].start)||g[a[b]].start()}}}(),g.widgetManager=function(){var a={"top:debug":"/t_w_debug.js","middle:subtrack":"/m_w_subtrack.js"},b={},c={},d=[];g.eventManager.add("_fireWidget",function(a){var b=g.eventManager.getMessageBody(a);e(b)&&g.widgetManager.fire(b.widget,b.options)});var e=function(a){return"object"===g.utils.extendedTypeOf(a)&&"string"===g.utils.extendedTypeOf(a.widget)},f=function(b){var c="https://"+g.CDN.DOMAIN+g.CDN.BASE;g.utils.empty(g.settings.version)||(c+="/"+g.settings.version),c+=a[b],g.utils.loadJS(c)};return{fire:function(a,b){(c[a]=c[a]||[]).push(b)},getDebugQueryParams:function(){var a="";return g.utils.empty(g.settings.widgets.debug)||g.utils.empty(g.settings.widgets.debug.key)||(a+="&ACCdebugKey="+g.settings.widgets.debug.key,a+="&ACCdebugMode="+(g.utils.empty(g.settings.widgets.debug.mode)?1:g.settings.widgets.debug.mode),a+="&ACCtimestamp="+1*new Date),a},getQueues:function(){return c},init:function(a){a=g.utils.extend(b,a||{});var c;for(c in a)if("object"===g.utils.extendedTypeOf(a[c]))switch(c){case g.WIDGET.DEBUG:-1===d.indexOf("top:debug")&&f("top:debug");break;case g.WIDGET.SUBTRACK:g.mode===g.MODE.MIDDLE.PROXY&&-1===d.indexOf("middle:subtrack")&&f("middle:subtrack")}},ressourceIncluded:function(a){d.push(a)}}}(),g.customEventManager=function(){var a={},b=[],c=function(a){-1===b.indexOf(a)&&b.push(a)},d=function(){var c,d;for(c=b.length-1;c>=0;c--)d=b[c],d in a&&"function"==typeof a[d]&&(b.splice(c,1),g.customEventManager.trigger(d))};return{add:function(b,c){var e=[];return"array"!==g.utils.extendedTypeOf(c)&&(c=[]),Object.keys(b).forEach(function(d){"function"==typeof b[d]&&-1!==c.indexOf(d)&&(a[d]=b[d],e.push(d))}),d(),e},trigger:function(b,d){return d=d||!1,b in a&&"function"==typeof a[b]?void a[b]():void(d?c(b):g.widgetManager.fire(g.WIDGET.DEBUG,{type:"warning",callee:"manager:custom_event",content:"Custom event name `"+b+"` not registered"}))}}}(),function(a){function b(b){var c;try{if(c=a.context.document.getElementById(b),"object"!=typeof c)return;return c}catch(d){return}}a.utils={};var c;a.utils.setContext=function(b){var c,d,e={startDate:b.date,window:b.window,document:b.document};e.isHTTPS="https:"===e.window.location.protocol,e.currentDomain=e.window.location.hostname,c=e.window.navigator.userAgent.match(/Chrome\/([\d]*)/),c&&(e.browserName="chrome",e.browserVersion=parseInt(c[1],10),e.devicePlatform=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e.window.navigator.userAgent)?"mobile":"desktop"),d=e.window.navigator.languages?e.window.navigator.languages[0]:e.window.navigator.language||e.window.navigator.userLanguage,d=d.split("-"),e.language="string"===a.utils.extendedTypeOf(d[0])?d[0].toLowerCase():"",e.countryCode="string"===a.utils.extendedTypeOf(d[1])?d[1].toLowerCase():"",e.timeZone="Intl"in e.window&&"DateTimeFormat"in e.window.Intl&&"resolvedOptions"in e.window.Intl.DateTimeFormat()&&"timeZone"in e.window.Intl.DateTimeFormat().resolvedOptions()?e.window.Intl.DateTimeFormat().resolvedOptions().timeZone:"",a.context=e},a.utils.loadJS=function(b){var c=a.context.document.createElement("script"),d=a.context.document.getElementsByTagName("script")[0];c.async=1,c.src=b,d.parentNode.insertBefore(c,d)},a.utils.loadCSS=function(b){var c=a.context.document.createElement("link"),d=a.context.document.getElementsByTagName("head")[0];c.rel="stylesheet",like.type="text/css",c.media="all",c.href=b,d.appendChild(c)},a.utils.onSuccess=function(b,c){var d;if("object"===a.utils.extendedTypeOf(b)&&"onSuccess"in b)return d=b.onSuccess,delete b.onSuccess,d(c)},a.utils.onError=function(b,c){var d;if("object"===a.utils.extendedTypeOf(b)&&"onError"in b)return d=b.onError,delete b.onError,d(a.utils.errorToString(c))},a.utils.errorToString=function(a){return"object"==typeof a&&"message"in a?a.message:"string"==typeof a?a:"misc error"},a.utils.extend=function(a,b){var c,d={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c]);return d},a.utils.extendedTypeOf=function(a){var b=Object.prototype.toString.call(a);return b.slice(8,b.length-1).toLowerCase()},a.utils.xhr=function(){var a=new XMLHttpRequest;return function(b,c,d){a.onreadystatechange=function(){4===a.readyState&&d(a.responseText)},a.open(b,c),a.send()}}(),a.utils.createIframe=function(b,c){var d=a.context.document.createElement("iframe");return d.src=b,d.height=d.width=1,d.name=c,d.style.border="none",d},a.utils.getMiddleFileURI=function(){return"https://"+a.settings.alias+a.MASTER.BASE+a.MASTER.PATH_TO_MIDDLE},a.utils.getMessageBody=function(a){var b;try{b=JSON.parse(a.data.body)}catch(c){return a.data.body}return b},a.utils.createPayloadMessage=function(a,b){var c={};if(a)return c.type=a,c.body=JSON.stringify(b),c},a.utils.createPayloadFeedback=function(b,c,d){var e={};if(b){if(e.type=b,d)e.error=a.utils.errorToString(d);else{if(!c)return;e.body=JSON.stringify(c)}return e}},a.utils.getMessageTopic=function(a){return"string"==typeof a.data.topic?a.data.topic:void 0},a.utils.empty=function(a){var b,c,d,e,f=[b,null,!1,0,"","0"];for(d=0,e=f.length;e>d;d++)if(a===f[d])return!0;if("object"==typeof a){for(c in a)return!1;return!0}return!1},a.utils.grep=function(b,c){var d,e,f=[];if("object"===a.utils.extendedTypeOf(b))for(d in b)b[d]===c&&f.push(d);else if("array"===a.utils.extendedTypeOf(b))for(e=0;e<b.length;e++)b[e]===c&&f.push(d);return f},a.utils.firstProp=function(a){for(var b in a)if(a.hasOwnProperty(b)&&"function"!=typeof b)return b;return null},a.utils.getISOTimestampDate=function(a){return a="undefined"!=typeof a?parseInt(a,10):0,new Date(Date.now()+a).toISOString()},a.utils.isValidDate=function(b){return"date"===a.utils.extendedTypeOf(b)&&!isNaN(b.getTime())},a.utils.show=function(a){var c="string"==typeof a?b(a):a;c&&(c.style.display="block")},a.utils.hide=function(a){var c="string"==typeof a?b(a):a;c&&(c.style.display="none")},a.utils.hasClass=function(a,c){var d="string"==typeof a?b(a):a;if(d)return new RegExp(" "+c+" ").test(" "+d.className+" ")},a.utils.addClass=function(c,d){var e="string"==typeof c?b(c):c;e&&(a.utils.hasClass(e,d)||(e.className+=" "+d))},a.utils.removeClass=function(a,c){var d="string"==typeof a?b(a):a;if(d){var e=" "+d.className.replace(/[\t\r\n]/g," ")+" ";if(this.hasClass(d,c)){for(;e.indexOf(" "+c+" ")>=0;)e=e.replace(" "+c+" "," ");d.className=e.replace(/^\s+|\s+$/g,"")}}},a.utils.sheet=function(){return c||(c=a.context.document.createElement("style"),c.appendChild(a.context.document.createTextNode("")),a.context.document.head.appendChild(c)),c.sheet},a.utils.getCSSRule=function(b,c,d,e){var f=function(a){return a+";"};return b+"{"+(c||[]).map(f).join("")+("desktop"===a.context.devicePlatform?(d||[]).map(f).join(""):(e||[]).map(f).join(""))+"}"},a.utils.createCookie=function(b,c,d){var e,f="",g=new Date;"number"==typeof d&&d>0&&(e=new Date,e.setTime(g.getTime()+60*d*60*1e3),f="; expires="+e.toGMTString()),a.context.document.cookie=b+"="+c+f+"; path=/"},a.utils.deleteCookie=function(b){a.context.document.cookie=b+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"},a.utils.cookieExists=function(b,c){return 0===a.context.document.cookie.indexOf(b)?-1<a.context.document.cookie.indexOf(c?b+"="+c+";":b+"="):c&&a.context.document.cookie.indexOf("; "+b+"="+c)+b.length+c.length+3===a.context.document.cookie.length?!0:-1<a.context.document.cookie.indexOf("; "+(c?b+"="+c+";":b+"="))},a.utils.readCookie=function(b){b=b.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1");var c=new RegExp("(?:^|;)\\s?"+b+"=(.*?)(?:;|$)","i"),d=a.context.document.cookie.match(c);return d&&d[1]},a.utils.getNavigatorLanguage=function(){var b=a.context.window.navigator.languages?a.context.window.navigator.languages[0]:a.context.window.navigator.language||a.context.window.navigator.userLanguage;return b=b.split("-")},a.utils.merge=function(a,b){return"undefined"==typeof a||null===a?a=[]:"[object Array]"!==Object.prototype.toString.call(a)&&(a=[a]),"undefined"==typeof b||null===b?b=[]:"[object Array]"!==Object.prototype.toString.call(b)&&(b=[b]),a.concat(b)},a.utils.generateUUID=function(){var a=(new Date).getTime(),b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:3&c|8).toString(16)});return b},a.utils.localizeContent=function(b,c){var d,e,f=a.context.language;try{if("object"!==a.utils.extendedTypeOf(c))throw"contents is not an object";if("string"===a.utils.extendedTypeOf(c[b]))d=c[b];else{if("object"!==a.utils.extendedTypeOf(c[b]))throw"no value provided";if(e=a.utils.firstProp(c[b]),"string"===a.utils.extendedTypeOf(c[b][f]))d=c[b][f];else{if(!e||"string"!==a.utils.extendedTypeOf(c[b][e]))throw"no string value provided";d=c[b][e]}}}catch(g){return d=""}return d},a.utils.getQueryKey=function(b){var c,d,e,f=a.context.window.location.search.substring(1),g=f.split("&");for(c=0;c<g.length;c++)if(d=g[c].split("="),d[0]==b)return-1!=d[1].indexOf("%20")?(e=d[1].split("%20"),e[0]+" "+e[1]):d[1];return null}}(g),function(b){function c(){l=a.q.slice(),a.q=[],a.q.push=function(){var a,c,d,e,g,h,j;if(a=Array.prototype.slice.call(arguments),"arguments"!==b.utils.extendedTypeOf(a[0])&&0===a[0].length&&"array"!==b.utils.extendedTypeOf(a[0][0])&&0===a[0][0].length)return void b.widgetManager.fire(b.WIDGET.DEBUG,{type:"error",contents:["Commands is not valid",a]});for(j=0;j<a[0].length;j++)c=a[0][j],"array"===b.utils.extendedTypeOf(c)&&c.length?(d=c[0],e=c[1],g=c[2],i(d)?(h=d.split(":")[0],b.dependencyManager.isDependencyPrepared(h)?f(d,e,g):(l.push([d,e,g]),b.widgetManager.fire(b.WIDGET.DEBUG,{type:"warning",content:"Dependency `"+h+"` not prepared yet, stored in pending queue"}))):b.widgetManager.fire(b.WIDGET.DEBUG,{type:"error",contents:["Command action is not valid",d]})):b.widgetManager.fire(b.WIDGET.DEBUG,{type:"error",contents:["Command is not an array nor filled",c]})}}function d(){var a=!0;a:for(;a;){a=!1;var c,d,e,f,g,h=[];for(c=l.length-1;c>=0;c--)if(f=l[c],"arguments"===b.utils.extendedTypeOf(f)){if(!f.length){l.splice(c,1),a=!0,c=d=e=f=g=h=void 0;continue a}for(d=0;d<f.length;d++)g=f[d],"array"===b.utils.extendedTypeOf(g)&&g.length?h.push(g):b.widgetManager.fire(b.WIDGET.DEBUG,{type:"error",contents:["Pending command were not an array type nor filled",g]});for(l.splice(c,1),e=h.length-1;e>=0;e--)l.splice(c,0,h[e]);a=!0,c=d=e=f=g=h=void 0;continue a}b.widgetManager.fire(b.WIDGET.DEBUG,{type:"log",content:"Pending queue flattened, "+l.length+" commands pending"})}}function e(){var a=!0;a:for(;a;){a=!1;var c,d,e,g,h,j;if(!l.length)return;for(c=0;c<l.length;c++){if(d=l[c],"array"!==b.utils.extendedTypeOf(d)||!d.length){b.widgetManager.fire(b.WIDGET.DEBUG,{type:"error",contents:["Pending command is not an array nor filled",d]}),l.splice(c,1),a=!0,c=d=e=g=h=j=void 0;continue a}if(e=l[c][0],g=l[c][1],h=l[c][2],!i(e)){b.widgetManager.fire(b.WIDGET.DEBUG,{type:"warning",contents:["Pending command action is not valid, command trashed",e,JSON.stringify(l[c])]}),l.splice(c,1),a=!0,c=d=e=g=h=j=void 0;continue a}if(j=e.split(":")[0],b.dependencyManager.isDependencyPrepared(j)){l.splice(c,1),f(e,g,h),a=!0,c=d=e=g=h=j=void 0;continue a}}}}function f(a,c,d){return b.widgetManager.fire(b.WIDGET.DEBUG,{type:"log",contents:["Applying command :",a,c,d]}),m.push([a,c,d]),"object"!==b.utils.extendedTypeOf(d)&&(d={}),b.logicManager.exist(a)?b.logicManager.apply(a,c,d):b.utils.downwardMessage(a,c,{onSuccess:function(a){return b.utils.onSuccess(d,a)},onError:function(c){var e=b.utils.errorToString(c);return"Event type does not exist"===e?b.utils.onError(d,"Given command `"+a+"` does not exist"):b.utils.onError(d,e)}})}function g(a,c){var d;return c=c||{},"object"!==b.utils.extendedTypeOf(a)?b.utils.onError(c,"Provided command options is not an object"):(d=b.customEventManager.add(a,["sdkLoaded"]),d.length?b.utils.onSuccess(c,d):b.utils.onError(c,"No listeners added"))}function h(){var a=b.utils.getMiddleFileURI()+"?"+b.widgetManager.getDebugQueryParams(),c=b.utils.createIframe(a,b.MODE.MIDDLE.PROXY),d=function(){b.widgetManager.fire(b.WIDGET.DEBUG,{type:"warning",content:"Middle is waiting for the <body> to be created. If you read this log, please note that this could mean that the `DOMContentLoaded` event takes some time to fire"}),b.context.document.addEventListener("DOMContentLoaded",function(){return e()},!1)},e=function(){return"object"!=typeof b.context.document.body.appendChild(c)?b.widgetManager.fire(b.WIDGET.DEBUG,{type:"error",content:"Middle has not been loaded, SDK loading state will then stop here."}):void(b.references.proxy=c.contentWindow)};return c.onload=function(a){b.context.window.addEventListener("message",function(a){b.eventManager.trigger(a)},!1)},"htmlbodyelement"!==b.utils.extendedTypeOf(b.context.document.body)?d():e()}function i(a){return"string"!==b.utils.extendedTypeOf(a)?!1:a.indexOf(":")<1||"_"===a.charAt(0)?!1:!0}function j(a,c){return a.topic=b.utils.generateUUID(),b.eventManager.add(a.topic,function(d){return b.eventManager.remove(a.topic),!b.utils.empty(d.data.body)&&"onSuccess"in c?c.onSuccess.apply(this,[d.data.body]):!b.utils.empty(d.data.error)&&"onError"in c?c.onError.apply(this,[d.data.error]):void 0}),b.references.proxy.postMessage(a,b.utils.getMiddleFileURI())}b.top={};var k={},l=[],m=[];k._dependencyLoaded=function(a){var c=b.eventManager.getMessageBody(a);b.dependencyManager.dependencyLoaded(c),b.widgetManager.fire(b.WIDGET.DEBUG,{type:"log",content:"`"+c+"` loaded +"+(1*new Date-b.context.startDate)+" ms"}),b.dependencyManager.prepareDependency(c),-1!==["core","storage"].indexOf(c)&&b.dependencyManager.isDependencyLoaded("core")&&b.dependencyManager.isDependencyLoaded("storage")&&(b.utils.downwardMessage("_core:instanciateUser",{browserName:b.context.browserName,browserVersion:b.context.browserVersion,countryCode:b.context.countryCode,devicePlatform:b.context.devicePlatform,language:b.context.language,time_zone:b.context.timeZone,__currentDomain:b.context.currentDomain},{onSuccess:function(a){a=JSON.parse(a),b.utils.downwardMessage("_fireWidget",{widget:b.WIDGET.SUBTRACK,options:{type:"start",clientId:a.UDID,masterDomain:b.settings.alias,navigatingDomain:a.__currentDomain}}),b.utils.downwardMessage("_fireWidget",{widget:b.WIDGET.SUBTRACK,options:{type:"page",url:b.context.window.location.pathname}})}}),b.utils.downwardMessage("_notifyIncludedRessources",b.dependencyManager.getIncludedRessources()))},k._dependencyPrepared=function(a){var c=b.eventManager.getMessageBody(a);b.dependencyManager.dependencyPrepared(c),b.widgetManager.fire(b.WIDGET.DEBUG,{type:"log",content:"`"+c+"` prepared +"+(1*new Date-b.context.startDate)+" ms"}),b.dependencyManager.isSDKLoaded()&&e()},k._sdkLoaded=function(){b.dependencyManager.SDKLoaded(),b.widgetManager.fire(b.WIDGET.DEBUG,{type:"success",content:"SDK loaded +"+(1*new Date-b.context.startDate)+" ms"}),b.customEventManager.trigger("sdkLoaded",!0),b.utils.downwardMessage("_fireWidget",{widget:b.WIDGET.SUBTRACK,options:{type:"event",category:"SDK",action:"load",value:1*new Date-b.context.startDate}}),b.dependencyManager.startDependencies(),c(),d(),e()},k["_top:loadRessource"]=function(a){var c=b.eventManager.getMessageBody(a);c&&b.utils.loadJS(c)},k._triggerCustomEvent=function(a){var c=b.eventManager.getMessageBody(a);"string"==typeof c&&b.customEventManager.trigger("string")},b.top.prepare=function(){return a.q=a.q||[],b.utils.downwardMessage=n,b.utils.downwardFeedback=o,b.widgetManager.init(b.settings.widgets),b.eventManager.bind(k),b.logicManager.add("core:addCustomListeners",g),b.widgetManager.fire(b.WIDGET.DEBUG,{type:"log",contents:["`top` configured +"+(1*new Date-b.context.startDate)+" ms",b.settings]}),h()};var n=function(a,c,d){var e=b.utils.createPayloadMessage(a,c);if(e)return d?j(e,d):b.references.proxy.postMessage(e,b.utils.getMiddleFileURI())},o=function(a,c,d){var e=b.utils.createPayloadFeedback(a,c,d);if(e)return b.references.proxy.postMessage(e,b.utils.getMiddleFileURI())}}(g),function(a){a.middle={};var b={};b._downLoaded=function(b){a.references.down.onmessage=i,a.context.window.removeEventListener("message",c),a.context.window.addEventListener("message",j,!1)},b._notifyIncludedRessources=function(b){a.settings.includedRessources=a.eventManager.getMessageBody(b);var c,d,e,f=a.dependencyManager.getIncludedRessources();for(c in f)if(c in a.settings.includedRessources)for(d=0;d<f[c].length;d++)e=f[c][d],-1===a.settings.includedRessources[c].indexOf(e)&&a.settings.includedRessources[c].push(f[c][d]);else a.settings.includedRessources[c]=f[c];a.utils.downwardMessage("_notifyIncludedRessources",a.settings.includedRessources)},b._dependencyLoaded=function(b){var c=a.eventManager.getMessageBody(b);a.dependencyManager.dependencyLoaded(c),a.dependencyManager.prepareDependency(c),a.utils.forwardMessage("_dependencyLoaded",c)},b._dependencyPrepared=function(b){var c=a.eventManager.getMessageBody(b);a.dependencyManager.dependencyPrepared(c),a.utils.forwardMessage("_dependencyPrepared",c)},b._sdkLoaded=function(b){a.dependencyManager.SDKLoaded(),a.dependencyManager.startDependencies(),a.utils.forwardMessage("_sdkLoaded")},b["_middle:loadRessource"]=function(b){var c=a.eventManager.getMessageBody(b);if(c){var d=a.context.document.createElement("script"),e=a.context.document.getElementsByTagName("script")[0];d.async=1,d.src=c,e.parentNode.insertBefore(d,e)}},a.middle.prepare=function(){if(a.mode===a.MODE.MIDDLE.PROXY){var i="https://"+a.settings.alias+a.MASTER.BASE+a.MASTER.PATH_TO_WW+"?"+a.widgetManager.getDebugQueryParams();a.references.down=new Worker(i),a.settings=h,a.references.down.onmessage=c,a.utils.forwardMessage=d,a.utils.forwardFeedback=g,a.utils.downwardMessage=e,a.utils.downwardFeedback=f,a.context.window.addEventListener("message",c,!1),a.eventManager.bind(b),a.widgetManager.init(a.settings.widgets),a.widgetManager.fire(a.WIDGET.DEBUG,{type:"log",content:"`middle` configured"})}};var c=function(b){a.eventManager.trigger(b)},d=function(b,c){var d=a.utils.createPayloadMessage(b,c);if(d)return a.context.window.parent.postMessage(d,"*")},e=function(b,c){var d=a.utils.createPayloadMessage(b,c);if(d)return a.references.down.postMessage(d)},f=function(b,c,d){var e=a.utils.createPayloadFeedback(b,c,d);if(e)return a.references.down.postMessage(e)},g=function(b,c,d){var e=a.utils.createPayloadFeedback(b,c,d);if(e)return a.context.window.parent.postMessage(e,"*")},i=function(b){var c=a.eventManager.getMessageType(b);return a.eventManager.exist(c)?a.eventManager.trigger(b):a.context.window.parent.postMessage(b.data,"*")},j=function(b){var c=a.eventManager.getMessageType(b);return a.eventManager.exist(c)?a.eventManager.trigger(b):a.references.down.postMessage(b.data)}}(g),a.l=function(a){return a.apply(g)},function(a){function b(b){return I=a.utils.extend(I,JSON.parse(b)),a.widgetManager.fire(a.WIDGET.DEBUG,{type:"log",callee:K,contents:["SW feedback to push plugin w/ state",I]}),a.utils.empty(I.token)?d():c(I.token),a.eventManager.bind(G),a.logicManager.add("push:askPermission",a.push.askPermission),a.logicManager.add("push:showAlert",a.push.showAlert),a.logicManager.add("push:isCompliant",a.push.isCompliant),a.logicManager.add("push:launchLandingOnClick",i),a.logicManager.add("push:addCustomListeners",f),h(),a.utils.downwardMessage("_dependencyPrepared","push")}function c(b,c){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"info",callee:K,contents:["handling optin case",b]}),a.utils.downwardMessage("_core:updateUser",{__token:b,system_optin_notifs:"Y"},c)}function d(b){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"info",callee:K,content:"handling optout case"}),a.utils.downwardMessage("_core:updateUser",{system_optin_notifs:"N"},b)}function e(a,b){return"onError"in b?b.onError("Current browser is not compliant for web push nor targeted by your configuration"):void 0}function f(b,c){var d;return c=c||{},"object"!==a.utils.extendedTypeOf(b)?a.utils.onError(c,"Provided command options is not an object"):(d=a.customEventManager.add(b,H),d.length?a.utils.onSuccess(c,d):a.utils.onError(c,"No listeners added"))}function g(){return-1!==C.browsers.indexOf(a.context.browserName)&&"serviceWorker"in a.context.window.navigator&&"Notification"in a.context.window}function h(){var b={onSuccess:function(b){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"success",callee:K,contents:["Scenario `"+C.scenario+"` launched success",b]})},onError:function(b){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"error",callee:K,contents:["Scenario `"+C.scenario+"` launched error",b]})}};switch(a.utils.grep(z,C.scenario).length||(C.scenario=z.NONE),a.widgetManager.fire(a.WIDGET.DEBUG,{type:"log",callee:K,content:"Select scenario : `"+C.scenario+"`"}),C.scenario){case z.SHOW_ALERT:a.push.showAlert(null,b)}}function i(b,c){var d,e,f,g,h=j(),i=[],k=[];if(c=c||{},h)return a.utils.onError(c,h);if("array"!==a.utils.extendedTypeOf(b))return a.utils.onError(c,"Provided command options is not an array");for(f=0;f<b.length;f++)if(d=b[f],!("string"!=typeof d||d.length<2)&&-1===i.indexOf(d))if("#"===d.charAt(0)&&(k=[a.context.document.getElementById(d.substr(1,d.length))]),"."===d.charAt(0)&&(k=a.context.document.getElementsByClassName(d.substr(1,d.length))),k&&k.length)for(g=0;g<k.length;g++)e=k[g],"htmlanchorelement"===a.utils.extendedTypeOf(e)&&(e.addEventListener?e.addEventListener("click",function(b){a.utils.downwardMessage("_fireWidget",{widget:a.WIDGET.SUBTRACK,options:{type:"event",category:"Launch Landing",action:"click",label:"accept"}}),a.push.launchPopup(b)}):e.attachEvent&&e.attachEvent("onclick",function(b){a.utils.downwardMessage("_fireWidget",{widget:a.WIDGET.SUBTRACK,options:{type:"event",category:"Launch Landing",action:"click",label:"accept"}}),a.push.launchPopup(b)}),-1===i.indexOf(d)&&i.push(d));else k=null;return i.length?(a.utils.downwardMessage("_fireWidget",{widget:a.WIDGET.SUBTRACK,options:{type:"event",category:"Launch Landing",action:"bind",value:i.length}}),a.utils.onSuccess(c,i)):a.utils.onError(c,"No elements were binded because no Anchors </a> were provided")}function j(){return"denied"===I.permission?"Notification permission is denied by the user":I.token?"User is already optin":!1}function k(){"htmldivelement"===a.utils.extendedTypeOf(a.context.document.getElementById(u.ALERT_ID))&&a.context.document.getElementById(u.ALERT_ID).parentNode.removeChild(a.context.document.getElementById(u.ALERT_ID));var b,c=a.context.document.createElement("div"),d=a.context.document.getElementsByTagName("body")[0];c=l(c,C.alertOptions.theme,C.alertOptions.position);try{if(c.id=u.ALERT_ID,b=d.appendChild(c),"object"!=typeof b)throw new Error("Appended alert failed")}catch(e){return Promise.reject(e.message)}return Promise.resolve()}function l(b,c,d){var e=u.ALERT_ID;switch(b.innerHTML='<div id="'+e+'-body"><a href="#" id="'+e+'-close" class="'+u.CLOSE_LINK_CLASS+'"></a><div id="'+e+'-content" class="'+u.MISC_CONTENT_CLASS+'"></div></div><div id="'+e+'-buttons"><a href="#" class="'+e+"-button "+e+"-success "+u.ACCEPT_LINK_CLASS+" "+u.ACCEPT_CONTENT_CLASS+'"></a><a href="#" class="'+e+"-button "+e+"-error "+u.DENY_LINK_CLASS+" "+u.DENY_CONTENT_CLASS+'"></a></div>',c){case t.LIGHT:case t.DARK:var f=A[c],g=a.context.document.createElement("style"),h="";h+=a.utils.getCSSRule("#"+e+" *",null,["box-sizing: border-box"],["box-sizing: initial"]),h+=a.utils.getCSSRule("#"+e,["position: fixed","background: "+f.container.bg,"box-shadow: 0 1px 4px rgba(0,0,0,0.3)","overflow: hidden","font-family: Arial, Helvetica, sans-serif","z-index: 999"],["top: "+f.container.desktop.gap+"px","right: "+f.container.desktop.gap+"px","width: "+f.container.desktop.width+"px","height: auto","min-height: "+f.container.desktop.height+"px","border-radius: "+f.container.desktop.radius+"px"],["width: 100%","bottom: 0"]),h+=a.utils.getCSSRule("#"+e+"-body",["position: relative","height: auto","z-index: 1","margin-bottom: "+f.buttons.height+"px"],["width: 100%","padding: "+f.body.desktop.padding[0]+"px "+f.body.desktop.padding[1]+"px "+f.body.desktop.padding[2]+"px "+f.body.desktop.padding[3]+"px"],["width: 90%","left: 50%","padding: "+f.body.mobile.padding[0]+"px "+f.body.mobile.padding[1]+"px "+f.body.mobile.padding[2]+"px "+f.body.mobile.padding[3]+"px","transform: translateX(-50%)"]),h+=a.utils.getCSSRule("#"+e+"-close",["position: absolute","top: "+f.close.size/2+"px","height: "+f.close.size+"px","width: "+f.close.size+"px","opacity: 0.5","z-index: 2"],["right: "+(f.close.size/2-1)+"px"],["right: 8px"]),h+=a.utils.getCSSRule("#"+e+"-close:hover",["opacity: 1"]),h+=a.utils.getCSSRule("#"+e+"-close:before, #"+e+"-close:after",["position: absolute","left: "+f.close.size/4+"px",'content: " "',"width: "+(f.close.size/4-1)+"px","background-color: "+f.close.color],["height: "+(f.close.size+1)+"px"],["height: 20px"]),h+=a.utils.getCSSRule("#"+e+"-close:before",["transform: rotate(45deg)"]),h+=a.utils.getCSSRule("#"+e+"-close:after",["transform: rotate(-45deg)"]),h+=a.utils.getCSSRule("#"+e+"-content",["position: relative","left: 0","right: 0","width: auto","padding-right: 30px","color: "+f.content.color]),h+=a.utils.getCSSRule("#"+e+"-buttons",["position: absolute","bottom: 0","height: "+f.buttons.height+"px","text-align: center","line-height: "+(f.buttons.height-5)+"px"],["width: 100%"],["width: 90%","left: 50%","padding: "+f.buttons.mobile.padding[0]+"px "+f.buttons.mobile.padding[1]+"px "+f.buttons.mobile.padding[2]+"px "+f.buttons.mobile.padding[3]+"px","transform: translateX(-50%)"]),h+=a.utils.getCSSRule("#"+e+"-buttons a",["position: relative","display: inline-block","min-width: "+(f.button.width-2*f.button.padding)+"px","text-align: center","border-radius: 3px","text-decoration: none","color: #ffffff","margin-right: "+f.buttons.gap+"px","text-shadow: 0 2px rgba(0,0,0,0.2)"],["height: "+f.button.height+"px","line-height: "+f.button.height+"px","padding: 0 "+f.button.padding+"px","width: auto"],["height: 45px","line-height: 47px","padding: 0","width: 155px","max-width: 47%"]),h+=a.utils.getCSSRule("#"+e+"-buttons a:last-child",["margin-right: 0"]),h+=a.utils.getCSSRule("#"+e+"-buttons a:active",["border: none","top: 2px"]),h+=a.utils.getCSSRule("#"+e+"-buttons ."+u.ACCEPT_LINK_CLASS,["background: "+f.button.accept.bg,"border-bottom: 2px solid "+f.button.accept.bottom]),h+=a.utils.getCSSRule("#"+e+"-buttons ."+u.ACCEPT_LINK_CLASS+":hover",["background: "+f.button.accept.hover]),h+=a.utils.getCSSRule("#"+e+"-buttons ."+u.DENY_LINK_CLASS,["background: "+f.button.deny.bg,"border-bottom: 2px solid "+f.button.deny.bottom]),h+=a.utils.getCSSRule("#"+e+"-buttons ."+u.DENY_LINK_CLASS+":hover",["background: "+f.button.deny.hover]),"mobile"===a.context.devicePlatform&&(h+="@media all and (min-width: 650px) {",h+=a.utils.getCSSRule("#"+e,["background-color: rgba(0, 0, 0, 0)","box-shadow: none","padding-top: 15px"]),h+=a.utils.getCSSRule("#"+e+"-body",["min-width: 650px","background: "+f.container.bg,"width: 60%","max-width: 1200px","box-shadow: 0 1px 7px rgba(0, 0, 0, 0.3)","padding-bottom: 70px","margin-bottom: 0","z-index: 1"]),h+=a.utils.getCSSRule("#"+e+"-buttons",["min-width: 650px","background: "+f.container.bg,"width: 60%","max-width: 1200px","z-index: 2"]),h+=a.utils.getCSSRule("#"+e+"-content",["margin: 0 auto","padding: 0 30px"]),h+="}"),h+=a.utils.getCSSRule("."+e+"--left",["right: initial !important","left: "+f.container.desktop.gap+"px"]),h+=a.utils.getCSSRule("."+e+"--bottom",["top: initial !important","bottom: "+f.container.desktop.gap+"px"]),h+=a.utils.getCSSRule("."+e+"-close--left",["right: initial !important;left: "+(f.close.size/2+2)+"px"]),h+=a.utils.getCSSRule("."+e+"--hidden",["display: none"]),g.innerHTML=h,a.context.document.head.appendChild(g),"desktop"===a.context.devicePlatform&&(-1!==[v.TOP_LEFT,v.BOTTOM_LEFT].indexOf(d)&&a.utils.addClass(b,e+"--left"),-1!==[v.BOTTOM_LEFT,v.BOTTOM_RIGHT].indexOf(d)&&a.utils.addClass(b,e+"--bottom"))}return a.utils.addClass(b,e+"--hidden"),a.utils.addClass(b,e+"--"+a.context.devicePlatform),
b}function m(){try{var b,c=a.context.document.getElementById(u.ALERT_ID),d=c.getElementsByClassName(u.MISC_CONTENT_CLASS),e=c.getElementsByClassName(u.DENY_CONTENT_CLASS),f=c.getElementsByClassName(u.ACCEPT_CONTENT_CLASS);for(b=0;b<d.length;b++)d[b].innerHTML=a.utils.localizeContent("misc",C.alertOptions.contents);for(b=0;b<e.length;b++)e[b].innerHTML=a.utils.localizeContent("deny",C.alertOptions.contents);for(b=0;b<f.length;b++)f[b].innerHTML=a.utils.localizeContent("accept",C.alertOptions.contents)}catch(g){return Promise.reject(g.message)}return Promise.resolve()}function n(){try{var b,c=a.context.document.getElementById(u.ALERT_ID),d=c.getElementsByClassName(u.ACCEPT_LINK_CLASS),e=c.getElementsByClassName(u.DENY_LINK_CLASS),f=c.getElementsByClassName(u.CLOSE_LINK_CLASS);for(b=0;b<d.length;b++)d[b].addEventListener?d[b].addEventListener("click",function(b){a.utils.downwardMessage("_fireWidget",{widget:a.WIDGET.SUBTRACK,options:{type:"event",category:"HTML Alert",action:"click",label:"accept"}}),a.push.launchPopup(b)}):d[b].attachEvent&&d[b].attachEvent("onclick",function(b){a.utils.downwardMessage("_fireWidget",{widget:a.WIDGET.SUBTRACK,options:{type:"event",category:"HTML Alert",action:"click",label:"accept"}}),a.push.launchPopup(b)});for(b=0;b<e.length;b++)e[b].addEventListener?e[b].addEventListener("click",function(b){a.utils.downwardMessage("_fireWidget",{widget:a.WIDGET.SUBTRACK,options:{type:"event",category:"HTML Alert",action:"click",label:"deny"}}),o(b)}):e[b].attachEvent&&e[b].attachEvent("onclick",function(b){a.utils.downwardMessage("_fireWidget",{widget:a.WIDGET.SUBTRACK,options:{type:"event",category:"HTML Alert",action:"click",label:"deny"}}),o(b)});for(b=0;b<f.length;b++)f[b].addEventListener?f[b].addEventListener("click",function(b){a.utils.downwardMessage("_fireWidget",{widget:a.WIDGET.SUBTRACK,options:{type:"event",category:"HTML Alert",action:"click",label:"close"}}),q()}):f[b].attachEvent&&f[b].attachEvent("onclick",function(b){a.utils.downwardMessage("_fireWidget",{widget:a.WIDGET.SUBTRACK,options:{type:"event",category:"HTML Alert",action:"click",label:"close"}}),q()})}catch(g){return Promise.reject(g.message)}return Promise.resolve()}function o(b){b.preventDefault(),a.utils.createCookie(x,JSON.stringify([y.DENY,a.utils.getISOTimestampDate()]),w),q()}function p(){a.utils.removeClass(u.ALERT_ID,u.ALERT_ID+"--hidden"),a.utils.addClass(u.ALERT_ID,u.ALERT_ID+"--visible")}function q(){a.utils.removeClass(u.ALERT_ID,u.ALERT_ID+"--visible"),a.utils.addClass(u.ALERT_ID,u.ALERT_ID+"--hidden")}function r(){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"info",callee:K,content:"Closing the Landing Popup"}),J&&(J.close(),"global"!==a.utils.extendedTypeOf(J)&&(J=null))}a.push={};var s=["chrome"],t={BLANK:"blank",LIGHT:"light",DARK:"dark"},u={ALERT_ID:"acc-alert",CLOSE_LINK_CLASS:"acc--closeLink",DENY_LINK_CLASS:"acc--denyLink",DENY_CONTENT_CLASS:"acc--denyContent",ACCEPT_LINK_CLASS:"acc--acceptLink",ACCEPT_CONTENT_CLASS:"acc--acceptContent",MISC_CONTENT_CLASS:"acc--miscContent"},v={TOP_RIGHT:"topRight",TOP_LEFT:"topLeft",BOTTOM_RIGHT:"bottomRight",BOTTOM_LEFT:"bottomLeft"},w=720,x="acc_alert",y={IDDLE:"U",DENY:"N"},z={NONE:"none",SHOW_ALERT:"showAlert"},A={},B={container:{desktop:{gap:10,width:400,height:150,radius:4}},body:{desktop:{padding:[25,20,10,20]},mobile:{padding:[10,8,15,8]}},close:{size:12},content:{},buttons:{height:50,gap:10,mobile:{padding:[8,8,5,8]}},button:{width:100,height:35,padding:8}};A[t.LIGHT]=JSON.parse(JSON.stringify(B)),A[t.LIGHT].container.bg="#FBFBFB",A[t.LIGHT].close.color="#000000",A[t.LIGHT].content.color="#333333",A[t.LIGHT].button.deny={bg:"#E94B36",hover:"#E7402A",bottom:"#C43927"},A[t.LIGHT].button.accept={bg:"#4EB669",hover:"#23B05E",bottom:"#179B53"},A[t.DARK]=JSON.parse(JSON.stringify(B)),A[t.DARK].container.bg="#8C8C8C",A[t.DARK].close.color="#000000",A[t.DARK].content.color="#E9E9E9",A[t.DARK].button.deny={bg:"#FA7866",hover:"#F26755",bottom:"#C43927"},A[t.DARK].button.accept={bg:"#91DBA4",hover:"#53D489",bottom:"#179B53"};var C={},D={browsers:s,scenario:z.NONE,alertOptions:{},landingOptinOptions:{}},E={theme:t.LIGHT,position:v.TOP_RIGHT,reAskingDelay:576},F={theme:t.LIGHT,width:462,height:135},G={},H=["landingFeedback:optin","landingFeedback:softOptout","landingFeedback:hardOptout"],I={swActivated:!1,token:null,permission:"none"},J=null,K="plugin:push";G["_push:popupFeedback"]=function(b){var e=a.eventManager.getMessageBody(b);I=a.utils.extend(I,e||{});var f={onSuccess:function(){return r()},onError:function(){return r()}};a.widgetManager.fire(a.WIDGET.DEBUG,{type:"info",callee:K,contents:["Receive feedback from popup",I]}),a.utils.empty(I.token)?d(f):c(I.token,f),a.utils.empty(I.token)?a.utils.empty(I.permission)||"denied"!==I.permission?a.customEventManager.trigger("landingFeedback:softOptout"):a.customEventManager.trigger("landingFeedback:hardOptout"):a.customEventManager.trigger("landingFeedback:optin")},G["_push:refreshState"]=function(b){var c=a.eventManager.getMessageBody(b);I=a.utils.extend(I,c),a.widgetManager.fire(a.WIDGET.DEBUG,{type:"info",callee:K,contents:["refreshState new value",I]})},a.push.start=function(){return a.mode===a.MODE.TOP?(C=a.utils.extend(D,a.settings.dependencies.push||{}),C.alertOptions=a.utils.extend(E,C.alertOptions),C.landingOptinOptions=a.utils.extend(F,C.landingOptinOptions),g()?a.utils.downwardMessage("_sw:plugin_push_prepare",null,{onSuccess:b}):(a.widgetManager.fire(a.WIDGET.DEBUG,{type:"warning",callee:K,content:"browser not compliant or targeted"}),a.logicManager.add("push:askPermission",e),a.logicManager.add("push:showAlert",e),a.logicManager.add("push:launchLandingOnClick",e),a.logicManager.add("push:isCompliant",a.push.isCompliant),a.logicManager.add("push:addCustomListeners",f),a.utils.downwardMessage("_dependencyPrepared","push"))):void 0},a.push.askPermission=function(b,c){return c=c||{},a.utils.downwardMessage("_sw:plugin_push_askPermission",null,c)},a.push.isCompliant=function(b,c){return c=c||{},"serviceWorker"in a.context.window.navigator&&"Notification"in a.context.window?-1===C.browsers.indexOf(a.context.browserName)?a.utils.onError(c,"Browser not targeted by your configuration"):"denied"===I.permission?a.utils.onError(c,"User has denied notification permission"):a.utils.onSuccess(c):a.utils.onError(c,"Technically uncompliant for web push")},a.push.showAlert=function(b,c){c=c||{};var d,e,f,g,h=j(),i=a.utils.readCookie(x);if(i)try{if(i=JSON.parse(i),"array"!==a.utils.extendedTypeOf(i))throw"sCookie is not an array";if(d=i[0],e=i[1],!a.utils.isValidDate(new Date(e)))throw"cookieCreationDate is not a valid date";if("number"!=typeof C.alertOptions.reAskingDelay&&C.alertOptions.reAskingDelay>=0)throw"settings.alertOptions.reAskingDelay is not a positive number";g=3600*C.alertOptions.reAskingDelay*1e3,f=e<a.utils.getISOTimestampDate(-g)}catch(l){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"warning",callee:K,contents:["Push showAlert retrieve cookie value warning",l]}),d=null,e=null,f=null}return h?a.utils.onError(c,h):d===y.DENY?(a.utils.createCookie(x,JSON.stringify([y.DENY,a.utils.getISOTimestampDate()]),w),a.utils.onError(c,"User has previously denied the alert")):d!==y.IDDLE||f?(a.utils.createCookie(x,JSON.stringify([y.IDDLE,a.utils.getISOTimestampDate()]),w),k().then(m).then(n).then(p).then(function(){a.utils.downwardMessage("_fireWidget",{widget:a.WIDGET.SUBTRACK,options:{type:"event",category:"HTML Alert",action:"display"}}),a.utils.onSuccess(c)})["catch"](function(b){a.utils.onError(c,b)})):a.utils.onError(c,"Alert already showed, `reAskingDelay` is not overdue")},a.push.launchPopup=function(b){var c="acc_landing#"+a.utils.generateUUID(),d="https://"+a.settings.alias+a.MASTER.BASE+a.MASTER.PATH_TO_LANDING,e="menubar=no, status=no, scrollbars=no, toolbar=no, menubar=no, location=no, directories=no, resizable=no, width="+C.landingOptinOptions.width+", height="+C.landingOptinOptions.height,f=j();if("preventDefault"in b&&"function"==typeof b.preventDefault&&b.preventDefault(),f)return void a.widgetManager.fire(a.WIDGET.DEBUG,{type:"warning",callee:K,content:f});a.eventManager.add(c,function(){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"info",callee:K,content:"Popup launched"}),a.eventManager.remove(c),q()});try{if(J=a.context.window.open(d,c,e),-1===["global","window"].indexOf(a.utils.extendedTypeOf(J)))throw new Error("Landing not launched")}catch(g){J=null,a.eventManager.remove(c),a.widgetManager.fire(a.WIDGET.DEBUG,{type:"warning",callee:K,contents:["Unable to launch popup",a.utils.errorToString(g)]})}},a.dependencyManager.ressourceIncluded("push","top:push")}(g),function(a){function b(){return"serviceworker"===a.utils.extendedTypeOf(d().controller)?Promise.resolve():Promise.reject("Service Worker not activated")}function c(){var b="https://"+a.settings.alias+a.MASTER.BASE+a.MASTER.PATH_TO_SW+"sw_"+a.context.browserName+".js";return a.context.window.navigator.serviceWorker.register(b,{scope:"./"}).then(h)}function d(){return j?j.window.navigator.serviceWorker:a.context.window.navigator.serviceWorker}function e(b){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"debug",callee:k,contents:["receive message from SW",b]});var c=a.eventManager.getMessageBody(b);a.utils.forwardMessage(c.type,c.body)}function f(b){return"chrome"===a.context.browserName&&a.context.browserVersion>=44?b.pushManager.subscribe({userVisibleOnly:!0})["catch"](function(a){return Promise.reject(a)}):"chrome"===a.context.browserName&&a.context.browserVersion<44?b.pushManager.getSubscription()["catch"](function(a){return Promise.reject(a)}):Promise.reject("not a chrome browser")}function g(b){return"chrome"===a.context.browserName&&a.context.browserVersion>=44?b.endpoint:b.endpoint+"/"+b.subscriptionId}function h(){return b()["catch"](i)}function i(){return a.widgetManager.fire(a.WIDGET.DEBUG,{type:"log",callee:k,content:"Initiating bridge..."}),new Promise(function(b,c){var d=a.utils.createIframe(a.utils.getMiddleFileURI(),a.MODE.MIDDLE.BRIDGE);d.onload=function(){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"log",callee:k,content:"...Bridge initiated"}),b()},"object"==typeof a.context.document.body.appendChild(d)?j=d.contentWindow:c("Invalid bridge iframe")})}a.swHandler={};var j=null,k="plugin:sw_handler";a.eventManager.add("_sw:plugin_push_prepare",function(c){var h=a.eventManager.getMessageTopic(c),i={};return a.swHandler.getNotificationPermission().then(function(a){i.permission=a}).then(b).then(function(){d().onmessage=e,i.swActivated=!0}).then(function(){return"granted"!==i.permission?Promise.reject("permission not granted"):d().ready}).then(f).then(g).then(function(a){i.token=a})["catch"](function(a){}).then(function(){return a.utils.forwardFeedback(h,i)})}),a.eventManager.add("_sw:plugin_push_askPermission",function(b){var c=a.eventManager.getMessageTopic(b);return a.widgetManager.fire(a.WIDGET.DEBUG,{type:"log",callee:k,content:"test"}),a.swHandler.askPermission().then(function(b){"granted"===b?a.utils.forwardFeedback(c,"permission granted"):a.utils.forwardFeedback(c,null,"permission not granted")})["catch"](function(b){a.utils.forwardFeedback(c,null,"error while asking permission")})}),a.eventManager.add("_sw:broadcast",function(b){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"info",callee:k,contents:["Middle has received a sw:broadcast event",b]});var c=a.eventManager.getMessageBody(b);a.swHandler.broadcast(c.type,c.body)}),a.swHandler.install=function(){return c().then(function(){return Promise.resolve()})},a.swHandler.makeSubscription=function(){return b()["catch"](function(){return Promise.reject("SW_not_fully_ready")}).then(function(){return d().ready.then(f).then(g)})},a.swHandler.broadcast=function(c,e){return b().then(function(){return d().controller.postMessage({type:"_broadcast",body:{type:c,body:e}})})["catch"](function(){a.widgetManager.fire(a.WIDGET.DEBUG,{type:"warn",callee:k,content:"Service Worker not activated to broadcast message"})})},a.swHandler.getNotificationPermission=function(){return a.context.window.navigator.permissions.query({name:"notifications"}).then(function(a){return"state"in a?a.state:Promise.reject()})["catch"](function(){return"none"})},a.swHandler.askPermission=function(b,c){return c=c||{},new Promise(function(b){a.context.window.Notification.requestPermission(function(a){return"granted"===a?("onSuccess"in c&&c.onSuccess(!0),b(a)):("onError"in c&&c.onError("notification permission not granted"),b(a))})})},a.dependencyManager.ressourceIncluded("push","middle:swHandler")}(g),b()}}(a[a.AccengageWebSDKObject])}(window);